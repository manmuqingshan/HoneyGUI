# SConscript

from building import *
from honeygui import *
from SCons.Script import Flatten
import os
import menu_config

cwd = GetCurrentDir()
src = Glob('*.c')
CPPDEFINES = []
CPPPATH = [cwd]
CPPPATH += [os.path.join(cwd, 'root_image_800_480')]


if GetDepend('CONFIG_REALTEK_BUILD_GUI_800_480_DEMO'):
    CPPDEFINES += ['ENABLE_RTK_GUI_800_480_DEMO']
    CPPDEFINES += ['DRV_LCD_WIDTH=800']
    CPPDEFINES += ['DRV_LCD_HIGHT=480']
    CPPDEFINES += ['DRV_PIXEL_BITS=16']
    if hasattr(menu_config, 'ARCH') and menu_config.ARCH == 'win32':
        print("Target arch is win32, attempting to add prebuilt binary object...")
        BIN_SUBDIR = os.path.join(cwd, 'root_image_800_480')
        BIN_FILE = os.path.join(BIN_SUBDIR, 'root_0x4400000.bin')
        OBJ_FILE = os.path.join(BIN_SUBDIR, 'root_0x4400000_bin.o')
        result_node = add_prebuilt_binary_object(BIN_FILE, OBJ_FILE)
        if result_node:
            additional_objs = []
            additional_objs.append(result_node)
            src = Flatten(src + additional_objs)


group = DefineGroup('realgui/demo', src, depend = ['CONFIG_REALTEK_BUILD_GUI_800_480_DEMO'], CPPPATH = CPPPATH, CPPDEFINES = CPPDEFINES)

Return('group')
